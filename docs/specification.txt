Техническое задание: Инструмент для управления настройками гаммы для OS Linux с графическим пользовательским интерфейсом

1. Бизнес-требования
Проблема: работа с командой xgamma возможна только через терминал, что не удобно для пользователя
Цель: повысить удобство настройки гаммы, снизить количество время на подбор параметров и добавление нужных значений в автозагрузку
Скоуп проекта:
    Входит: простой минималистичный интерфейс, добавление команд xgamma в автозагрузку, удаление команд из автозагрузки
    Не входит: сложные операции с ОС

2. Общее описание
Название: xgamma GUI Tool
Описание: графический инструмент для управления настройками гаммы дисплея с помощью команды xgamma
Целевая ОС: Linux Mint / Ubuntu
Язык разработки: Python 3.8+
Язык интерфейса: английский (не изменяется)
Пользователи: максимально широкий круг, вне зависимости от уровня владения Linux
Зависимость: монитор подключен к ПК, xgamma установлена

3. Функциональные требования
3.1 Основные функции
Управление коррекцией гаммы для красного, зелёного и синего каналов в отдельности
Управление общей коррекцией гаммы (параметры красной, синей и зеленой гаммы равны)
Предпросмотр изменений гаммы в реальном времени
Применение сохранённых параметров при запуске системы - выполнение команды xgamma при запуске системы или авторизации пользователя
Сброс к значениям по умолчанию (1.000 для всех каналов) - удаление внесенных изменений в автозапуск

3.2 Параметры гаммы
Диапазон: от 0.001 до 5.000 для каждого канала
Шаг изменения: 0.001
Значения по умолчанию:
    Red: 1.000
    Green: 1.000
    Blue: 1.000
    All: 1.000

3.3 Интеграция с xgamma
Использование команды xgamma для фактического изменения гаммы
Формат команды: xgamma -rgamma {red} -ggamma {green} -bgamma {blue} -gamma {overall}
Проверка наличия установленной xgamma при запуске, установка зависимости xgamma при установке ПО
При запуске приложения значения RGB должны становится равными текущим значениям xgamma
    По умолчанию значения xgamma равны 1.000

4. Требования к пользовательскому интерфейсу
4.1 Макет главного окна
┌─────────────────────────────────────────────────────────────┐
│ xgamma GUI Tool                                  [_] [□] [X]│
├─────────────────────────────────────────────────────────────┤
|                                    [Warnings]  [Settings]   |
|                                                             |
│  ┌─────────────────────────────────────────────────────┐    │
│  │                ЭТАЛОННОЕ ИЗОБРАЖЕНИЕ                │    │
│  │ (Тестовый паттерн для визуальной калибровки гаммы)  │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  Red:    [══════════════════○══════════]   [1.000]          │
│  Green:  [════════════════════○════════]   [1.000]          │
│  Blue:   [═══════════════════════○═════]   [1.000]          │
│  All:    [══════════════════════○══════]   [1.000]          │
│                                                             │
│           [Reset]                   [Apply]                 │
└─────────────────────────────────────────────────────────────┘
4.2 Элементы интерфейса
Эталонное изображение: тестовый паттерн с градиентами и цветовыми блоками, динамически реагирующий на настройки гаммы
    Эталонное изображение генерировать программно, в цветовом диапазоне RGB, с визуальным отображением текущих значений гаммы
Ползунки: горизонтальные для каждого цветового канала и общей гаммы
Управление стрелками клавиатуры:
    По умолчанию никакой ползунок не изменяется нажатием стрелки клавиатуры
    При нажатии на ползунок или на поле он становится доступным для управления стрелкой, даже если значение не было изменено
    При нажатии на любой элемент UI, кроме ползунка, ползунки снова становятся недоступными для управления стрелкой
    Стрелка вправо - увеличение значения, стрелка влево - уменьшение значения
    Шаг изменения: 0.01, при зажатой клавише Shift - 0.1
Ползунок All синхронизирован с ползунками RGB - при его изменениия ползунки RGB становятся равными All
При изменении RGB ползунок All должен быть равен среднему арифметическому ползунков RGB
Поля значений: числовые поля, отображающие текущие значения ползунков
    Точность каждого поля: 3 знака после запятой
Кнопки управления:
    Reset: возврат всех значений к 1.000 и удаление сохраненных в автозапуске команд xgamma
    Apply: сохранение значений для автоматического применения
Минимальный размер окна на усмотрение разработчика и должен вмещать все элементы без искажения, максимальный - по размеру экрана
Иконки стандартные, нарисованные программно. Верхняя панель содержит кнопку Settings (открывает модальное окно настроек без функционального наполнения) и иконку Warnings, при наведении на которую отображается список выявленных проблем
Интерфейс согласно гайдлайнам Mint / Ubuntu

5. Техническая спецификация
5.1 Структура файлов
xgamma_gui_tool/
├── main.py                 # точка входа приложения
├── gamma_core.py           # логика управления гаммой
├── gui.py                  # реализация интерфейса
├── config_manager.py       # работа с конфигурацией
├── reference_image.py      # генерация эталонного изображения
├── requirements.txt        # зависимости Python
├── gamma_adjust.desktop    # desktop-файл для автозапуска
└── assets/
    └── icons/              # иконки приложения

Структура приведена для референса, при реализации от нее возможно отступить.

6. Детали реализации
6.1 GUI-фреймворк
Использовать PyQt5 для графического интерфейса
Адаптивный макет, сохраняющий пропорции при изменении размера окна
Обновление значений ползунков в реальном времени
Обновление гаммы в реальном времени

6.2 Обработка ошибок
Корректная реакция на отсутствие xgamma - выдать предупреждение с инструкцией по установке xgamma и закрыть приложение
Валидация числовых вводов - только числа, не текст
Обратная связь пользователю об успешных и неуспешных операциях преимущественно выводится в нижней строке окна приложения; модальные окна допускаются в исключительных случаях (критические ошибки, окно настроек)

6.3 Работа с автозапуском
При нажатии на кнопку Save в автозапуск добавляются команды формата "xgamma -rgamma {red}" с описанием "Applied by xgamma GUI Tool"
При нажатии на кнопку Reset из автозапуска удаляются все команды xgamma, вне зависимости от наличия описания
При применении команд автозапуска запуск GUI происходить не должен
Механизм применения: ~/.config/autostart/
На будущее необходимо подготовить возможность использования альтернативных методов

7. Сценарии использования
7.1 Обычная работа
Запустить приложение
Настроить ползунки до нужных значений
Отслеживать изменения на эталонном изображении
Нажать "Apply" для сохранения настроек

7.2 Тихий запуск (автозапуск)
При входе в систему автозапуск применяет выставленные пользователем значения xgamma

7.3 Функция сброса
Один клик сбрасывает все значения до 1.000 и удаляет сохраненные в автозапуске команды xgamma

8. Дополнительная информация
https://yuweijun.github.io/manpages/man1/xgamma.1.html - документация xgamma